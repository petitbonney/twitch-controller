<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
  </head>
  <body>
    <script>
      const HOST = "localhost";
      const PORT = 4040;
      const socket = io(`ws://${HOST}:${PORT}`);

      let voices;
      speechSynthesis.onvoiceschanged = () => {
        voices = speechSynthesis.getVoices();
        voices = voices.filter((v) => v.lang === "fr-FR");
        console.log(voices);
      };

      const speak = (text) => {
        console.log(text);
        const speech = new SpeechSynthesisUtterance(text);
        const voice = voices[Math.floor(Math.random() * voices.length)];
        speech.voice = voice;
        speechSynthesis.speak(speech);
      };

      socket.emit("room", "speech-synthesis");
      socket.on("speech", (text) => {
        speak(text);
      });
    </script>
  </body>
</html>
